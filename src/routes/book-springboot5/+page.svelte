<!-- auto-generated by QWER -->
<script lang="ts">
  /* eslint-disable @typescript-eslint/ban-ts-comment */
  // @ts-nocheck
  import Post from '$lib/layouts/post.svelte';
  import ImgZoom from '$lib/components/image_zoom.svelte';
  import Video from '$lib/components/video.svelte';
  import CodeCopy from '$lib/components/code_copy.svelte';
  import InfoBox from '$lib/components/info_box.svelte';
</script>

<Post>
  <article slot="post_content">
    <blockquote>
      <p>
        <a
          href="https://ridibooks.com/books/1160000073?_s=search&amp;_q=%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8+%ED%95%B5%EC%8B%AC&amp;_rdt_sid=search&amp;_rdt_idx=0"
          rel="external">
          스프링부트 핵심가이드
        </a>
        을 읽고 정리한 내용입니다.
      </p>
      <p>위 책의 Part 8를 읽고 정리한 내용을 다루고 있습니다.</p>
    </blockquote>
    <h1 id="part-8-spring-data-jpa"><a href="#part-8-spring-data-jpa">Part 8. Spring Data JPA 활용</a></h1>
    <h2 id="jpql"><a href="#jpql">JPQL</a></h2>
    <blockquote>
      <p><code class="inline-code-block">JPQL &lpar;JPA Query Language&rpar;</code></p>
      <p>
        JPQL은 JPA에서 사용할 수 있는 쿼리를 의미합니다. JPQL 문법은 SQL과 매우 비슷해서 데이터베이스 쿼리에 익숙한
        분들이라면 어렵지 않게 사용할 수 있습니다.
      </p>
      <p>
        SQL과 차이점은 SQL에서는 테이블이나 칼럼의 이름을 사용하는 것과 달리 JPQL은 엔티티 객체를 대상으로 수행하는
        쿼리이기 때문에 매핑된 엔티티의 이름과 필드의 이름을 사용한다는 것입니다.
      </p>
    </blockquote>
    <h2 id=""><a href="#">쿼리 메서드 살펴보기</a></h2>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token comment">// (리턴타입) + {주제 + 서술어(속성)} </span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> <span class="token function">findByLastnameAndEmail</span><span class="token punctuation">(</span><span class="token class-name">String</span> lastname<span class="token punctuation">,</span> <span class="token class-name">String</span> email<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      쿼리메서드는 크게 동작을 결정하는 주제(Subject)와 서술어(Predicate)로 구분합니다.
      <code class="inline-code-block">find...By</code>
      ,
      <code class="inline-code-block">exists...By</code>
      와 같은 키워드로 쿼리의 주제를 정하며
      <code class="inline-code-block">By</code>
      는 서술어의 시작을 나타내는 구분자 역할입니다.
    </p>
    <p>
      서술어 부분은 검색 및 정렬 조건을 지정하는 영역입니다. 기본적으로 엔티티의 속성으로 정의할 수 있고, AND, OR로
      확장하는 것도 가능합니다.
    </p>
    <h3 id=""><a href="#">쿼리 메서드의 주제 키워드</a></h3>
    <h4 id="exists-by"><a href="#exists-by">exists...By</a></h4>
    <p>특정 데이터가 존재하는지 확인하는 키워드입니다. 리턴 타입으로는 boolean을 사용합니다.</p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">boolean</span> <span class="token function">existsByNumber</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h4 id="count-by"><a href="#count-by">count...By</a></h4>
    <p>조회 쿼리를 수행한 후 쿼리 결과로 나온 레코드의 개수를 리턴합니다.</p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">long</span> <span class="token function">countByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h4 id="delete-by-remove-by"><a href="#delete-by-remove-by">delete...By, remove...By</a></h4>
    <p>삭제 쿼리를 수행합니다. 리턴 타입이 없거나 삭제한 횟수를 리턴합니다.</p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">void</span> <span class="token function">deleteByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">long</span> <span class="token function">removeByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h4 id="first-number-top-number"><a href="#first-number-top-number">...First(Number), ...Top(Number)</a></h4>
    <p>
      쿼리를 통해 조회된 결괏값의 개수를 제한하는 키워드입니다. 두 키워드는 동일한 동작을 수행하며, 주제와 By 사이에
      위치합니다. 일반적으로 이 키워드는 한 번의 동작으로 여러 건을 조회할 때 사용되며, 단 건으로 조회하기 위해서는 <code
        class="inline-code-block">
        &lpar;Number&rpar;
      </code>
      를 생략하면 됩니다.
    </p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">></span></span> <span class="token function">findFirst5ByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5건 조회</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">></span></span> <span class="token function">findTop100ByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 100건 조회</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findFirstByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 단건 조회</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h3 id=""><a href="#">쿼리 메서드의 조건자 키워드</a></h3>
    <h4 id="is-equals"><a href="#is-equals">Is, Equals</a></h4>
    <p>
      값의 일치를 조건으로 사용하는 키워드입니다. <code class="inline-code-block">Is</code>
      는 생략 가능하며
      <code class="inline-code-block">Equals</code>
      로 대체할 수 있습니다.
    </p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberIs</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberEquals</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumber</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h4 id="is-not"><a href="#is-not">(Is)Not</a></h4>
    <p>
      값의 불일치를 조건으로 사용하는 키워드입니다. <code class="inline-code-block">Is</code>
      는 생략 가능하며
      <code class="inline-code-block">Not</code>
      으로 대체할 수 있습니다.
    </p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberIsNot</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberNot</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h4 id="is-null-is-notnull"><a href="#is-null-is-notnull">(Is)Null, (Is)NotNull</a></h4>
    <p>
      값이 null인지 검사하는 키워드입니다. <code class="inline-code-block">Is</code>
      는 생략 가능하며
      <code class="inline-code-block">Null</code>
      로 대체할 수 있습니다.
    </p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberIsNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberIsNotNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h4 id="is-true-is-false"><a href="#is-true-is-false">(Is)True, (Is)False</a></h4>
    <p>
      값이 true인지 검사하는 키워드입니다. <code class="inline-code-block">Is</code>
      는 생략 가능하며
      <code class="inline-code-block">True</code>
      로 대체할 수 있습니다.
    </p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberIsTrue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberTrue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h4 id="and-or"><a href="#and-or">And, Or</a></h4>
    <p>여러 조건을 묶을 때 사용합니다</p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberAndName</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberOrName</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h4 id="is-greaterthan-is-lessthan-is-between">
      <a href="#is-greaterthan-is-lessthan-is-between">(Is)GreaterThan, (Is)LessThan, (Is)Between</a>
    </h4>
    <p>값의 크기를 비교하는 키워드입니다.</p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberGreaterThan</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// number > ?</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberGreaterThanEqual</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// number >= ?</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNumberBetween</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number1<span class="token punctuation">,</span> <span class="token class-name">Long</span> number2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// number1 &lt;= ? AND number2 >= ?</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h4 id="startingwite-endingwith-containing-like">
      <a href="#startingwite-endingwith-containing-like">StartingWite, EndingWith, Containing, Like</a>
    </h4>
    <p>
      문자열의 시작, 끝, 포함 여부를 검사하는 키워드입니다. <code class="inline-code-block">StartingWith</code>
      는
      <code class="inline-code-block">LIKE &#39;문자열%&#39;</code>
      ,
      <code class="inline-code-block">EndingWith</code>
      는
      <code class="inline-code-block">LIKE &#39;%문자열&#39;</code>
      ,
      <code class="inline-code-block">Containing</code>
      은
      <code class="inline-code-block">LIKE &#39;%문자열%&#39;</code>
      과 같은 동작을 수행합니다.
      <code class="inline-code-block">Like</code>
      키워드는 코드 수준에서 메서드를 호출하면서 전달하는 값에
      <code class="inline-code-block">%</code>
      를 포함시켜야 합니다.
    </p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNameStartingWith</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name LIKE 'name%'</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNameEndingWith</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name LIKE '%name'</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNameContaining</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name LIKE '%name%'</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Product</span> <span class="token function">findByNameLike</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name LIKE '%name%'</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <h3 id=""><a href="#">페이징 처리</a></h3>
    <blockquote>
      <p>
        <code class="inline-code-block">페이징</code>
        : 데이터베이스의 레코드를 개수로 나눠 페이지를 구분하는 것을 의미합니다.
      </p>
    </blockquote>
    <p>
      JPA에서는 이 같은 페이징 처리를 위해 <code class="inline-code-block">Page</code>
      ,
      <code class="inline-code-block">Pageable</code>
       인터페이스를 제공합니다.
    </p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">></span></span> <span class="token function">findByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Pageable</span> pageable<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      위와 같이 리턴 타입으로 <code class="inline-code-block">Page</code>
      를 사용하면 페이징 처리가 가능합니다.
      <code class="inline-code-block">Pageable</code>
       인터페이스는 페이징 처리에 필요한 정보를 담고 있습니다.
    </p>
    <p>
      서비스단에서 페이징 처리를 위해 <code class="inline-code-block">Pageable</code>
      인터페이스를 구현한
      <code class="inline-code-block">PageRequest</code>
       객체를 생성해야 합니다.
    </p>
    <p>(PageRequest는 Pageable 인터페이스의 구현체입니다.)</p>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">PageRequest</span> pageRequest <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0번째 페이지, 10개씩 조회</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">></span></span> products <span class="token operator">=</span> productRepository<span class="token punctuation">.</span><span class="token function">findByName</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> pageRequest<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <ul>
      <li>
        <code class="inline-code-block">of&lpar;int page, int size&rpar;</code>
         : 데이터를 정렬하지 않습니다.
      </li>
      <li>
        <code class="inline-code-block">of&lpar;int page, int size, Sort sort&rpar;</code>
         : sort에 의해 정렬합니다.
      </li>
      <li>
        <code class="inline-code-block">
          of&lpar;int page, int size, Direction direction, String... properties&rpar;
        </code>
         : Sort.by(direction, properties)에 의해 정렬합니다.
      </li>
    </ul>
  </article>
</Post>
