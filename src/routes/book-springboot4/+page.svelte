<!-- auto-generated by QWER -->
<script lang="ts">
  /* eslint-disable @typescript-eslint/ban-ts-comment */
  // @ts-nocheck
  import Post from '$lib/layouts/post.svelte';
  import ImgZoom from '$lib/components/image_zoom.svelte';
  import Video from '$lib/components/video.svelte';
  import CodeCopy from '$lib/components/code_copy.svelte';
  import InfoBox from '$lib/components/info_box.svelte';
</script>

<Post>
  <article slot="post_content">
    <blockquote>
      <p>
        <a
          href="https://ridibooks.com/books/1160000073?_s=search&amp;_q=%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8+%ED%95%B5%EC%8B%AC&amp;_rdt_sid=search&amp;_rdt_idx=0"
          rel="external">
          스프링부트 핵심가이드
        </a>
        을 읽고 정리한 내용입니다.
      </p>
      <p>위 책의 Part 6를 읽고 정리한 내용을 다루고 있습니다.</p>
    </blockquote>
    <h2 id=""><a href="#">엔티티 설계</a></h2>
    <blockquote>
      <p>
        엔티티(Entity)는 데이터베이스 테이블에 대응하는 클래스입니다. 엔티티에는 데이터베이스에 쓰일 테이블과 컬럼을
        정의합니다.
      </p>
    </blockquote>
    <p><ImgZoom src="/book-springboot4/a.png" alt="/book-springboot4/a.png"></ImgZoom></p>
    <div class="code-block titled">
      <h2 class="code-title">Product.java</h2>
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token comment">/// showLineNumber </span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDateTime</span></span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Entity</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"product"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Id</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span><span class="token constant">IDENTITY</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">Integer</span> price<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">Integer</span> stock<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> createdAt<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> updatedAt<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token comment">// ... getter/setter 생략</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      ddl-auto 값을 create 같은 테이블 생성하는 옵션으로 설정하면 쿼리문을 작성하지 않아도 데이터베이스에 테이블이
      자동으로 만들어집니다.
    </p>
    <h3 id=""><a href="#">엔티티 관련 기본 어노테이션</a></h3>
    <h4 id="entity"><a href="#entity">@Entity</a></h4>
    <p>
      해당 클래스가 엔티티임을 명시하기 위한 어노테이션. 클래스 자체는 테이블과 일대일로 매칭되며, 해당 클래스의
      인스턴스는 매핑되는 테이블에서 하나의 레코드를 의미합니다.
    </p>
    <h4 id="table"><a href="#table">@Table</a></h4>
    <p>
      엔티티 클래스는 테이블과 매핑되므로 특별한 경우가 아니면 @Table 어노테이션이 필요하지 않습니다. 클래스의 이름과
      테이블의 이름이 다른 경우에는 @Table 어노테이션을 사용해서 매핑할 테이블을 지정할 수 있습니다.
    </p>
    <h4 id="id"><a href="#id">@Id</a></h4>
    <p>엔티티 클래스의 필드는 테이블의 칼럼과 매핑됩니다.</p>
    <p>@Id 어노테이션이 선언된 필드는 테이블의 기본값 역할로 사용됩니다. 모든 엔티티는 @Id 어노테이션이 필요합니다.</p>
    <h4 id="generatedvalue"><a href="#generatedvalue">@GeneratedValue</a></h4>
    <p>일반적으로 @Id 어노테이션과 함께 사용됩니다. @GeneratedValue 어노테이션은 기본키의 생성 방법을 지정합니다.</p>
    <ul>
      <li>
        <code class="inline-code-block">AUTO</code>
         (default) : 특정 데이터베이스에 맞게 기본키를 자동으로 생성합니다.
      </li>
      <li>
        <code class="inline-code-block">IDENTITY</code>
         : 기본키 생성을 데이터베이스에 위임합니다. (데이터베이스의 AUTO_INCREMENT를 사용해 기본키를 생성합니다.)
      </li>
      <li>
        <code class="inline-code-block">SEQUENCE</code>
        : 데이터베이스의 시퀀스를 사용해 기본키를 생성합니다.
        <ul>
          <li>@SequenceGenerator 어노테이션으로 식별자 생성기를 설정하고 이를 통해 값을 자동 주입받습니다.</li>
          <li>SequenceGenerator를 정의할 때는 name, sequenceName, allocationSize를 지정해야 합니다.</li>
        </ul>
        <div class="code-block titled showLineNumber">
          <h2 class="code-title">Product.java</h2>
          <CodeCopy>
            <pre><code
                class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="line-number">1</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Entity</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">2</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@SequenceGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"product_seq"</span><span class="token punctuation">,</span> sequenceName <span class="token operator">=</span> <span class="token string">"product_seq"</span><span class="token punctuation">,</span> allocationSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">3</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span> </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">4</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Id</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">5</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span><span class="token constant">SEQUENCE</span><span class="token punctuation">,</span> generator <span class="token operator">=</span> <span class="token string">"product_seq"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">6</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">7</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
          </CodeCopy>
        </div>
      </li>
      <li>
        <code class="inline-code-block">TABLE</code>
        <ul>
          <li>어떤 DBMS를 사용하더라도 동일하게 동작하길 원할 경우 사용합니다.</li>
          <li>식별자로 사용할 숫자의 보관 테이블을 별도로 생성하여 엔티티를 생성할 때마다 값을 갱신하며 사용합니다.</li>
          <li>@TableGenerator 어노테이션으로 테이블 정보를 설정합니다.</li>
        </ul>
        <div class="code-block titled showLineNumber">
          <h2 class="code-title">Product.java</h2>
          <CodeCopy>
            <pre><code
                class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="line-number">1</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Entity</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">2</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@TableGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"product_seq"</span><span class="token punctuation">,</span> table <span class="token operator">=</span> <span class="token string">"product_seq"</span><span class="token punctuation">,</span> pkColumnName <span class="token operator">=</span> <span class="token string">"seq_name"</span><span class="token punctuation">,</span> valueColumnName <span class="token operator">=</span> <span class="token string">"next_val"</span><span class="token punctuation">,</span> allocationSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">3</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span> </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">4</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Id</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">5</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span><span class="token constant">TABLE</span><span class="token punctuation">,</span> generator <span class="token operator">=</span> <span class="token string">"product_seq"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">6</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">7</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
          </CodeCopy>
        </div>
      </li>
    </ul>
    <h4 id="column"><a href="#column">@Column</a></h4>
    <p>엔티티 클래스의 필드는 자동으로 테이블 칼럼으로 매핑됩니다.</p>
    <p>그래서 별다른 설정을 하지 않을 예정이라면 이 어노테이션을 명시하지 않아도 괜찮습니다.</p>
    <ul>
      <li>
        <code class="inline-code-block">name</code>
         : 매핑할 테이블의 칼럼명을 지정합니다. 명시하지 않으면 필드명과 동일한 칼럼명으로 매핑됩니다.
      </li>
      <li>
        <code class="inline-code-block">nullable</code>
         : null 값을 허용할지 여부를 지정합니다. 기본값은 true입니다.
      </li>
      <li>
        <code class="inline-code-block">unique</code>
         : 칼럼에 고유 제약 조건을 설정합니다. 기본값은 false입니다.
      </li>
      <li>
        <code class="inline-code-block">length</code>
         : 문자열 칼럼의 길이를 지정합니다. 기본값은 255입니다.
      </li>
    </ul>
    <h4 id="transient"><a href="#transient">@Transient</a></h4>
    <p>엔티티 클래스에는 선언돼 있는 필드지만 데이터베이스에서는 필요 없을 경우 이 어노테이션을 사용합니다.</p>
    <h2 id=""><a href="#">레포지토리 인터페이스 설계</a></h2>
    <blockquote>
      <p>레포지토리 인터페이스는 JpaRepositoy 인터페이스를 상속받아 기존의 다양한 메서드를 사용할 수 있습니다.</p>
      <p>
        JpaRepository를 상속받을 때는 제네릭 타입으로 엔티티 클래스(Product)와 기본키의 타입(@Id)을 지정해야 합니다.
      </p>
    </blockquote>
    <div class="code-block titled">
      <h2 class="code-title">ProductRepository.java</h2>
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ProductRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <blockquote>
      <p>레포지토리 인터페이스에는 메서드를 선언만 하고 구현하지 않습니다.</p>
      <p>JpaRepository 인터페이스를 상속받으면 기본적인 CRUD 메서드를 사용할 수 있습니다.</p>
      <p>또한 메서드의 이름을 통해 쿼리문을 자동으로 생성할 수 있습니다.</p>
    </blockquote>
    <h3 id=""><a href="#">레포지토리 메서드의 생성 규칙</a></h3>
    <p>커스텀 메서드를 생성할 때는 메서드의 이름을 통해 쿼리문을 자동으로 생성할 수 있습니다.</p>
    <p>메서드에 이름을 붙일 때는 첫 단어를 제외한 이후 단어들의 첫 글자를 대문자로 설정해야합니다.</p>
    <p>조회 메서드(find)에 조건으로 붙일 수 있는 키워드는 다음과 같습니다.</p>
    <ul>
      <li>
        <code class="inline-code-block">FindBy</code>
        : SQL의 WHERE 조건에 해당하는 메서드를 생성합니다.
        <ul>
          <li>예) findByName(String name) : name이라는 필드의 값이 name인 엔티티를 조회합니다.</li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">AND</code>
        ,
        <code class="inline-code-block">OR</code>
        : SQL의 AND, OR 조건에 해당하는 메서드를 생성합니다.
        <ul>
          <li>
            예) findByNameAndPrice(String name, Integer price) : name이라는 필드의 값이 name이고 price라는 필드의 값이
            price인 엔티티를 조회합니다.
          </li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">Like/NotLike</code>
        : SQL의 LIKE, NOT LIKE 조건에 해당하는 메서드를 생성합니다.
        <ul>
          <li>예) findByNameLike(String name) : name이라는 필드의 값이 name을 포함하는 엔티티를 조회합니다.</li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">StartWith/StartingWith</code>
        : 특정 문자열로 시작하는 엔티티를 조회합니다.
        <ul>
          <li>
            예) findByNameStartWith(String name) : name이라는 필드의 값이 name으로 시작하는 엔티티를 조회합니다.
            (대소문자 구분 없음)
          </li>
          <li>
            예) findByNameStartingWith(String name) : name이라는 필드의 값이 name으로 시작하는 엔티티를 조회합니다.
            (대소문자 구분 있음)
          </li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">EndWith/EndingWith</code>
        : 특정 문자열로 끝나는 엔티티를 조회합니다.
        <ul>
          <li>
            예) findByNameEndWith(String name) : name이라는 필드의 값이 name으로 끝나는 엔티티를 조회합니다. (대소문자
            구분 없음)
          </li>
          <li>
            예) findByNameEndingWith(String name) : name이라는 필드의 값이 name으로 끝나는 엔티티를 조회합니다.
            (대소문자 구분 있음)
          </li>
        </ul>
      </li>
      <li>
        그외에 <code class="inline-code-block">GreaterThan</code>
        ,
        <code class="inline-code-block">LessThan</code>
        ,
        <code class="inline-code-block">Between</code>
        ,
        <code class="inline-code-block">IsNull</code>
        ,
        <code class="inline-code-block">IsNotNull</code>
        ,
        <code class="inline-code-block">OrderBy</code>
         등의 키워드를 사용할 수 있습니다.
      </li>
    </ul>
    <h2 id="dao"><a href="#dao">DAO 설계</a></h2>
    <p>
      <code class="inline-code-block">DAO&lpar;Data Access Object&rpar;</code>
      는 데이터베이스에 접근하기 위한 로직을 관리하는 객체입니다.
    </p>
    <blockquote>
      <p>비즈니스 로직의 동작 과정에서 데이터를 조작하는 기능을 담당합니다.</p>
      <p>다만, 스프링 데이터 JPA에서 DAO의 개념은 레포지토리가 대체하고 있습니다.</p>
    </blockquote>
    <p>
      규모가 작은 서비에는 DAO를 별도로 설계하지 않고 바로 서비스 레이어에서 데이터베이스에 접근해서 구현하기도 하지만,
      이번 장에서는 DAO를 서비스 레이어와 레포지토리의 중간 계층을 구성하는 역할로 사용할 예정입니다.
    </p>
    <h3 id="dao"><a href="#dao">DAO 클래스 생성</a></h3>
    <p>
      DAO 클래스는 일반적으로 <code class="inline-code-block">인터페이스-구현체</code>
       구성으로 생성합니다. DAO 클래스는 의존성 결합을 낮추기 위한 디자인 패턴이며, 서비스 레이어에 DAO 객체를 주입받을 때
      인터페이스를 선언하는 방식으로 구성할 수 있습니다.
    </p>
    <div class="code-block">
      <CodeCopy>
        <pre><code>{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">src</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">└── main</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    └── java</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        └── com</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            └── springboot</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                └── jpa</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                    └── data</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                        ├── dao</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                        |   └── impl</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                        |       └── ProductDaoImpl.java</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                        │   └── ProductDao.java</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                        └── entity</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                            └── Product.java</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                        └── repository</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                            └── ProductRepository.java</div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <details>
      <summary>ProductDao.java</summary>
      <div markdown="1">
        <div class="code-block titled showLineNumber">
          <h2 class="code-title">ProductDao.java</h2>
          <CodeCopy>
            <pre><code
                class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="line-number">1</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>data<span class="token punctuation">.</span>dao</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">2</span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">3</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>data<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Product</span></span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">4</span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">5</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ProductDAO</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">6</span><span class="no-line-diff"></span></div><div class="code-content">    </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">7</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token class-name">Product</span> <span class="token function">insertProduct</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">8</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token class-name">Product</span> <span class="token function">selectProduct</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">9</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token class-name">Product</span> <span class="token function">updateProductName</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">10</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">void</span> <span class="token function">deleteProduct</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">11</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
          </CodeCopy>
        </div>
      </div>
    </details>

    <details>
      <summary>ProductDaoImpl.java</summary>
      <div markdown="1">
        <div class="code-block titled showLineNumber">
          <h2 class="code-title">ProductDaoImpl.java</h2>
          <CodeCopy>
            <pre><code
                class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="line-number">1</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>data<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">2</span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">3</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token comment">//import ...</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">4</span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">5</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Component</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">6</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProductDAOImpl</span> <span class="token keyword">implements</span> <span class="token class-name">ProductDAO</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">7</span><span class="no-line-diff"></span></div><div class="code-content">    </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">8</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ProductRepository</span> productRepository<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">9</span><span class="no-line-diff"></span></div><div class="code-content">    </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">10</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Autowired</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">11</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">public</span> <span class="token class-name">ProductDAOImpl</span><span class="token punctuation">(</span><span class="token class-name">ProductRepository</span> productRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">12</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token keyword">this</span><span class="token punctuation">.</span>productRepository <span class="token operator">=</span> productRepository<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">13</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">14</span><span class="no-line-diff"></span></div><div class="code-content">  </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">15</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Override</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">16</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">public</span> <span class="token class-name">Product</span> <span class="token function">insertProduct</span><span class="token punctuation">(</span><span class="token class-name">Product</span> product<span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">17</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token keyword">return</span> productRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">18</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">19</span><span class="no-line-diff"></span></div><div class="code-content">    </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">20</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Override</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">21</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">public</span> <span class="token class-name">Product</span> <span class="token function">selectProduct</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">22</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token keyword">return</span> productRepository<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">23</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">24</span><span class="no-line-diff"></span></div><div class="code-content">    </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">25</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Override</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">26</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token class-name">Product</span> <span class="token function">updateProductName</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">27</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">></span></span> selectedProduct <span class="token operator">=</span> productRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">28</span><span class="no-line-diff"></span></div><div class="code-content">        </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">29</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token class-name">Product</span> updatedProduct<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">30</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedProduct<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">31</span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token class-name">Product</span> product <span class="token operator">=</span> selectedProduct<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">32</span><span class="no-line-diff"></span></div><div class="code-content">            </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">33</span><span class="no-line-diff"></span></div><div class="code-content">            product<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">34</span><span class="no-line-diff"></span></div><div class="code-content">            product<span class="token punctuation">.</span><span class="token function">setUpdatedAt</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">35</span><span class="no-line-diff"></span></div><div class="code-content">            </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">36</span><span class="no-line-diff"></span></div><div class="code-content">            updatedProduct <span class="token operator">=</span> productRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">37</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">38</span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">39</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">40</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token keyword">return</span> updatedProduct<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">41</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">42</span><span class="no-line-diff"></span></div><div class="code-content">    </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">43</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Override</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">44</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">void</span> <span class="token function">deleteProduct</span><span class="token punctuation">(</span><span class="token class-name">Long</span> number<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">45</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span><span class="token punctuation">></span></span> selectedProduct <span class="token operator">=</span> productRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">46</span><span class="no-line-diff"></span></div><div class="code-content">        </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">47</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedProduct<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">48</span><span class="no-line-diff"></span></div><div class="code-content">          <span class="token class-name">Product</span> product <span class="token operator">=</span> selectedProduct<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">49</span><span class="no-line-diff"></span></div><div class="code-content">          </div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">50</span><span class="no-line-diff"></span></div><div class="code-content">          productRepository<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">51</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">52</span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">53</span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">54</span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="line-number">55</span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
          </CodeCopy>
        </div>
      </div>
    </details>

    <p>
      <code class="inline-code-block">getById&lpar;&rpar;</code>
      vs
      <code class="inline-code-block">findById&lpar;&rpar;</code>
    </p>
    <blockquote>
      <p>
        <code class="inline-code-block">getById&lpar;&rpar;</code>
        는 내부적으로 EntityManager의
        <code class="inline-code-block">getReference&lpar;&rpar;</code>
        메서드를 호출합니다. 이 메서드를 호출하면 프록시 객체를 리턴합니다. 실제 쿼리는 프록시 객체를 통해 최초로
        데이터에 접근하는 시점에 실행됩니다. 이때 데이터가 존재하지 않으면
        <code class="inline-code-block">EntityNotFoundException</code>
         예외가 발생합니다.
      </p>
      <p>
        <code class="inline-code-block">findById&lpar;&rpar;</code>
        는 내부적으로 EntityManager의
        <code class="inline-code-block">find&lpar;&rpar;</code>
         메서드를 호출합니다. 이 메서드는 영속성 컨텍스트의 캐시에서 값을 찾고, 캐시에 없으면 데이터베이스에서 값을 조회합니다.
        리턴 값으로 Optional 객체를 리턴합니다.
      </p>
    </blockquote>
  </article>
</Post>
