<!-- auto-generated by QWER -->
<script lang="ts">
  /* eslint-disable @typescript-eslint/ban-ts-comment */
  // @ts-nocheck
  import Post from '$lib/layouts/post.svelte';
  import ImgZoom from '$lib/components/image_zoom.svelte';
  import Video from '$lib/components/video.svelte';
  import CodeCopy from '$lib/components/code_copy.svelte';
  import InfoBox from '$lib/components/info_box.svelte';
</script>

<Post>
  <article slot="post_content">
    <h1 id=""><a href="#">서론</a></h1>
    <blockquote>
      <p>springboot 3.1.6, java 17, elasticsearch 8.6.2 버전을 사용하였습니다.</p>
    </blockquote>
    <InfoBox statusType="info" statusName="왜 도입하였나?">
      <p>
        개인 프로젝트를 진행하면서 <a
          href="https://www.data.go.kr/tcs/dss/selectFileDataDetailView.do?publicDataPk=15076735#tab-layer-openapi"
          rel="external">
          전주시 음식점 공공데이터
        </a>
        를 사용하여 맛집 정보를 제공하는 서비스를 만들고 있습니다.
      </p>
      <p>맛집 조회 API에서 구현하고자 하는 기능은 다음과 같습니다.</p>
      <ul>
        <li>맛집 이름으로 검색</li>
        <li>내 지역 기준으로 검색</li>
        <li>전체 맛집 조회</li>
      </ul>
      <p>
        RDB의 <code class="inline-code-block">Like 검색</code>
        을 사용해도 되지만, 데이터가 많아질수록 검색 속도가 느려지기 때문에
        <code class="inline-code-block">Elasticsearch</code>
        를 도입하게 되었습니다.
      </p>
    </InfoBox>
    <h1 id="elasticsearch"><a href="#elasticsearch">Elasticsearch란?</a></h1>
    <p>우선 엘라스틱서치에 대해 간단히 알아보겠습니다.</p>
    <InfoBox statusType="info" statusName="Elasticsearch">
      <p>Elasticsearch는 Apache Lucene 기반의 Java 오픈소스 분산 검색 엔진입니다.</p>
      <p>역색인 기반의 검색 엔진으로, 데이터를 저장할 때 역색인을 생성하여 검색 속도를 높입니다.</p>
      <blockquote>
        <p>
          <code class="inline-code-block">역색인&lpar;Inverted Index&rpar;</code>
           : 보통 책의 뒷 페이지에 있는 색인처럼, 특정 단어가 어느 문서에 있는지를 기록한 색인
        </p>
        <p>
          역색인은 특정 단어가 어느 문서에 있는지를 기록하기 때문에, 특정 단어를 검색할 때 모든 문서를 훑어보지 않고
          역색인을 통해 검색할 문서를 빠르게 찾을 수 있습니다.
        </p>
        <p>
          <ImgZoom
            src="/springboot-elasticsearch/images/8b093260.png"
            alt="/springboot-elasticsearch/images/8b093260.png"></ImgZoom>
        </p>
      </blockquote>
      <p>Elasticsearch는 검색을 위해 단독으로 사용되기도 하며</p>
      <p>ELK 스택(Elasticsearch, Logstash, Kibana)의 중요한 구성 요소로 사용되기도 합니다.</p>
    </InfoBox>
    <h2 id="elasticsearch-vs-rdb"><a href="#elasticsearch-vs-rdb">Elasticsearch vs RDB</a></h2>
    <p>
      <ImgZoom src="/springboot-elasticsearch/images/bb144efe.png" alt="/springboot-elasticsearch/images/bb144efe.png"
      ></ImgZoom>
    </p>
    <p>RDB와 Elasticsearch의 차이점은 다음과 같습니다.</p>
    <ul>
      <li>
        <code class="inline-code-block">RDB</code>
        <ul>
          <li>정형화된 데이터를 저장하기 위해 설계된 데이터베이스</li>
          <li>데이터를 테이블에 저장하고, 테이블 간의 관계를 정의</li>
          <li>테이블에 저장된 데이터를 검색하기 위해 SQL을 사용</li>
          <li>데이터의 일관성을 보장하기 위해 트랜잭션을 사용</li>
          <li>데이터의 무결성을 보장하기 위해 제약 조건을 사용</li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">Elasticsearch</code>
        <ul>
          <li>비정형화된 데이터를 저장하기 위해 설계된 데이터베이스</li>
          <li>데이터를 문서에 저장하고, 문서 간의 관계를 정의하지 않음</li>
          <li>문서에 저장된 데이터를 검색하기 위해 JSON기반의 DSL을 사용</li>
          <li>데이터의 일관성을 보장하지 않음</li>
          <li>데이터의 무결성을 보장하지 않음</li>
        </ul>
      </li>
    </ul>
    <h2 id="elasticsearch"><a href="#elasticsearch">Elasticsearch의 특징</a></h2>
    <ul>
      <li>
        <code class="inline-code-block">분산형 구조</code>
        <ul>
          <li>여러 대의 서버에 데이터를 분산 저장하고, 검색 요청을 분산 처리</li>
          <li>서버가 추가되거나 삭제되어도 클러스터를 중단시키지 않고 계속 운영 가능</li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">RESTful API</code>
        <ul>
          <li>
            HTTP 프로토콜을 사용하여 데이터를 색인하고, 검색 가능
            <table>
              <thead>
                <tr>
                  <th><strong>Data CRUD</strong></th>
                  <th><strong>Elasticsearch Resfful</strong></th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Create</td>
                  <td>PUT</td>
                </tr>
                <tr>
                  <td>Read</td>
                  <td>GET</td>
                </tr>
                <tr>
                  <td>Update</td>
                  <td>POST</td>
                </tr>
                <tr>
                  <td>Delete</td>
                  <td>DELETE</td>
                </tr>
              </tbody>
            </table>
          </li>
        </ul>
      </li>
    </ul>
    <h1 id="elasticsearch-docker"><a href="#elasticsearch-docker">Elasticsearch 설치 (Docker)</a></h1>
    <p>
      간단히 설치하기 위해 <code class="inline-code-block">docker-compose</code>
      를 사용했습니다.
    </p>
    <details>
      <summary>docker-compose.yml</summary>

      <div class="code-block titled">
        <h2 class="code-title">docker-compose.yml</h2>
        <CodeCopy>
          <pre><code
              class="language-yaml">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.7'</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token key atrule">services</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token key atrule">elasticsearch</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token key atrule">build</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token key atrule">context</span><span class="token punctuation">:</span> ./elastic</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> Dockerfile</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token key atrule">args</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token key atrule">VERSION</span><span class="token punctuation">:</span> 8.6.2</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> elasticsearch</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token key atrule">environment</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token punctuation">-</span> xpack.security.enabled=false <span class="token comment"># 보안 기능 비활성화</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token punctuation">-</span> discovery.type=single<span class="token punctuation">-</span>node <span class="token comment"># 단일 노드로 실행 </span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token key atrule">ulimits</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token key atrule">memlock</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token key atrule">soft</span><span class="token punctuation">:</span> <span class="token number">-1</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token key atrule">hard</span><span class="token punctuation">:</span> <span class="token number">-1</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token key atrule">nofile</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token key atrule">soft</span><span class="token punctuation">:</span> <span class="token number">65536</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token key atrule">hard</span><span class="token punctuation">:</span> <span class="token number">65536</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token key atrule">cap_add</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token punctuation">-</span> IPC_LOCK</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token punctuation">-</span> elasticsearch<span class="token punctuation">-</span>data<span class="token punctuation">:</span>/usr/share/elasticsearch/data</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token key atrule">ports</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token punctuation">-</span> <span class="token string">"9200:9200"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token punctuation">-</span> <span class="token string">"9300:9300"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token key atrule">volumes</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token key atrule">elasticsearch-data</span><span class="token punctuation">:</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token key atrule">driver</span><span class="token punctuation">:</span> local</div></div>`}</code></pre>
        </CodeCopy>
      </div>
    </details>

    <details>
      <summary>Dockerfile</summary>

      <div class="code-block titled">
        <h2 class="code-title">Dockerfile</h2>
        <CodeCopy>
          <pre><code
              class="language-dockerfile">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">ARG VERSION</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">FROM docker.elastic.co/elasticsearch/elasticsearch:&#36;{VERSION}</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">RUN elasticsearch-plugin install analysis-nori</div></div>`}</code></pre>
        </CodeCopy>
      </div>
    </details>

    <p>
      <code class="inline-code-block">docker-compose.yml</code>
      파일을 보면
      <code class="inline-code-block">elasticsearch</code>
      서비스를 실행하기 위해
      <code class="inline-code-block">Dockerfile</code>
      을 사용하고 있습니다.
    </p>
    <p>
      따로 <code class="inline-code-block">Dockerfile</code>
      을 만든 이유는
      <code class="inline-code-block">elasticsearch</code>
      에
      <code class="inline-code-block">nori</code>
       플러그인을 설치하기 위해서입니다.
    </p>
    <InfoBox statusType="tip" statusName="nori 플러그인">
      <p>
        한글 형태소 분석기인 <code class="inline-code-block">nori</code>
         플러그인을 설치하면 한글을 분석할 수 있습니다.
      </p>
    </InfoBox>
    <h2 id="springboot-elasticsearch"><a href="#springboot-elasticsearch">Springboot와 Elasticsearch 연동</a></h2>
    <p>
      <code class="inline-code-block">Springboot</code>
      와
      <code class="inline-code-block">Elasticsearch</code>
      를 연동하기 위해
      <code class="inline-code-block">spring-boot-starter-data-elasticsearch</code>
       의존성을 추가합니다.
    </p>
    <div class="code-block titled">
      <h2 class="code-title">build.gradle</h2>
      <CodeCopy>
        <pre><code
            class="language-groovy">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">dependencies <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    implementation <span class="token string">'org.springframework.boot:spring-boot-starter-data-elasticsearch'</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      그리고 <code class="inline-code-block">ElasticConfig</code>
      클래스에
      <code class="inline-code-block">Elasticsearch</code>
       설정을 추가합니다.
    </p>
    <div class="code-block titled">
      <h2 class="code-title">ElasticSearchConfig.java</h2>
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Configuration</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@EnableElasticsearchRepositories</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@EnableElasticsearchAuditing</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ElasticSearchConfig</span> <span class="token keyword">extends</span> <span class="token class-name">ElasticsearchConfiguration</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Override</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">public</span> <span class="token class-name">ClientConfiguration</span> <span class="token function">clientConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token keyword">return</span> <span class="token class-name">ClientConfiguration</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                                  <span class="token punctuation">.</span><span class="token function">connectedTo</span><span class="token punctuation">(</span><span class="token string">"localhost:9200"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                                  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>
      이제 <code class="inline-code-block">Elasticsearch</code>
      와
      <code class="inline-code-block">Springboot</code>
       연동이 완료되었습니다.
    </p>
    <h1 id="elasticsearch"><a href="#elasticsearch">Elasticsearch 사용하기</a></h1>
    <p>
      우선 공공데이터에서 받아온 데이터는 RDB에 저장되어 있기 때문에 <code class="inline-code-block">
        Elasticsearch
      </code>
      에 데이터를 색인해야 합니다.
    </p>
    <ol>
      <li>
        <code class="inline-code-block">Logstash</code>
        를 사용하여 RDB에서 데이터를 가져와
        <code class="inline-code-block">Elasticsearch</code>
        에 색인
      </li>
      <li>
        <code class="inline-code-block">Springboot</code>
        애플리케이션에서 실시간으로
        <code class="inline-code-block">Elasticsearch</code>
        에 색인
      </li>
    </ol>
    <p>
      저는 두 가지 방법 중 고민하다가 2번 방법을 선택했습니다. 우선 <code class="inline-code-block">Logstash</code>
      는 별도의 서버가 필요해서 관리 비용이 높고 러닝커브가 있기 때문에 비교적 간단하고 직관적인 2번 방법을
      선택했습니다.
    </p>
    <h2 id="springboot-elasticsearch"><a href="#springboot-elasticsearch">Springboot에서 Elasticsearch 색인하기</a></h2>
    <p>
      우선 색인 과정은, 공공데이터를 한달에 한번 스케쥴링으로 가져와서 RDB에 저장하는데 이때 같이 <code
        class="inline-code-block">
        Elasticsearch
      </code>
      에도 색인을 진행합니다.
    </p>
    <details>
      <summary>RestaurantService.java</summary>

      <div class="code-block">
        <CodeCopy>
          <pre><code
              class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Transactional</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token comment">// 한달에 한번씩 실행</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"0 0 0 1 * *"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fetchAndSaveRestaurants</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">int</span> page <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">int</span> perPage <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token class-name">RestaurantDataResponse</span> response<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">do</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        response <span class="token operator">=</span> <span class="token function">fetchRestaurantsFromAPI</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> perPage<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Restaurant</span><span class="token punctuation">></span></span> restaurants <span class="token operator">=</span> <span class="token function">convertToRestaurants</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Restaurant</span><span class="token punctuation">></span></span> existingRestaurantsMap <span class="token operator">=</span> <span class="token function">getExistingRestaurantsMap</span><span class="token punctuation">(</span>restaurants<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Restaurant</span><span class="token punctuation">></span></span> newRestaurants <span class="token operator">=</span> <span class="token function">getNewRestaurants</span><span class="token punctuation">(</span>restaurants<span class="token punctuation">,</span> existingRestaurantsMap<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token function">saveRestaurants</span><span class="token punctuation">(</span>newRestaurants<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        page<span class="token operator">++</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> response<span class="token punctuation">.</span><span class="token function">perPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> response<span class="token punctuation">.</span><span class="token function">totalCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"fetch and save restaurants success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token function">indexingToES</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Transactional</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token comment">// 한시간에 한번씩 실행</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Scheduled</span><span class="token punctuation">(</span>cron <span class="token operator">=</span> <span class="token string">"0 0 * * * *"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">indexingToES</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token comment">// 1시간 이내에 수정된 식당만 elasticsearch에 저장</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token class-name">LocalDateTime</span> oneHourAgo <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">minusHours</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Restaurant</span><span class="token punctuation">></span></span> restaurants <span class="token operator">=</span> restaurantRepository<span class="token punctuation">.</span><span class="token function">findByModifiedAtAfterAndApprovedAtIsNotNull</span><span class="token punctuation">(</span>oneHourAgo<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token keyword">if</span> <span class="token punctuation">(</span>restaurants<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"No restaurants updated in the last hour"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RestaurantSearch</span><span class="token punctuation">></span></span> restaurantSearches <span class="token operator">=</span> restaurants<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                                                           <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">RestaurantSearch</span><span class="token operator">::</span><span class="token function">from</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">                                                           <span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    restaurantSearchRepositoryImpl<span class="token punctuation">.</span><span class="token function">bulkInsertOrUpdate</span><span class="token punctuation">(</span>restaurantSearches<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"elasticsearch indexing success"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
        </CodeCopy>
      </div>
    </details>

    <ul>
      <li>
        <code class="inline-code-block">fetchAndSaveRestaurants&lpar;&rpar;</code>
        <ul>
          <li>공공데이터에서 맛집 정보를 가져와서 RDB에 저장</li>
          <li>
            RDB에 저장된 맛집 정보를 Elasticsearch에 색인 (
            <code class="inline-code-block">indexingToES&lpar;&rpar;</code>
             호출)
          </li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">indexingToES&lpar;&rpar;</code>
        <ul>
          <li>RDB에 저장된 맛집 정보를 Elasticsearch에 색인</li>
          <li>이후에는 1시간에 한번씩 실행되어 RDB에 저장된 맛집 정보를 Elasticsearch에 색인</li>
        </ul>
      </li>
    </ul>
    <p>
      이렇게 RDB와 Elasticsearch의 데이터 동기화를 맞추면 Elasticsearch에 색인된 데이터를 사용하여 검색 API를 구현할 수
      있습니다.
    </p>
    <h2 id="elasticsearch-api"><a href="#elasticsearch-api">Elasticsearch 검색 API 구현준비</a></h2>
    <p>API를 구현하기 전에 사전작업을 진행해야 합니다.</p>
    <ol>
      <li>Elasticsearch용 Document 클래스 생성</li>
      <li>Document 클래스를 사용하기 위한 Repository 생성</li>
    </ol>
    <p>
      마치 JPA를 사용할 때 엔티티 클래스를 생성하고, 엔티티 클래스를 사용하기 위한 Repository를 생성하는 것과
      비슷합니다.
    </p>
    <h3 id="elasticsearch-document"><a href="#elasticsearch-document">Elasticsearch용 Document 클래스 생성</a></h3>
    <details>
      <summary>RestaurantSearch.java</summary>

      <div class="code-block titled">
        <h2 class="code-title">RestaurantSearch.java</h2>
        <CodeCopy>
          <pre><code
              class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>indexName <span class="token operator">=</span> <span class="token string">"restaurant"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Mapping</span><span class="token punctuation">(</span>mappingPath <span class="token operator">=</span> <span class="token string">"elastic/restaurant-search-mapping.json"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Setting</span><span class="token punctuation">(</span>settingPath <span class="token operator">=</span> <span class="token string">"elastic/restaurant-search-setting.json"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Getter</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@AllArgsConstructor</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestaurantSearch</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Id</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Text</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Text</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"roadAddress"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">String</span> roadAddress<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Text</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"address"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">String</span> address<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Text</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"phoneNumber"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">String</span> phoneNumber<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Double</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"lat"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">Double</span> lat<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Double</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"lon"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">Double</span> lon<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Text</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"description"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">String</span> description<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Double</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"rating"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">Double</span> rating<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Field</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token class-name">FieldType<span class="token punctuation">.</span>Integer</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">"reviewCount"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token class-name">Integer</span> reviewCount<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
        </CodeCopy>
      </div>
    </details>

    <p>위 코드를 살펴보겠습니다.</p>
    <ul>
      <li>
        <code class="inline-code-block">@Document</code>
        <ul>
          <li>
            <code class="inline-code-block">indexName</code>
             : Elasticsearch에 색인될 때 사용될 인덱스 이름 (= Table 이름)
          </li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">@Mapping</code>
        <ul>
          <li>
            <code class="inline-code-block">mappingPath</code>
             : Elasticsearch에 색인될 때 사용될 매핑 파일 경로
          </li>
          <li>매핑 파일은 Elasticsearch에 색인될 때 사용될 데이터의 타입을 정의합니다.</li>
          <li>
            따로 매핑 파일을 작성하지 않고, <code class="inline-code-block">@Field</code>
             어노테이션을 사용해도 됩니다.
          </li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">@Setting</code>
        <ul>
          <li>
            <code class="inline-code-block">settingPath</code>
             : Elasticsearch에 색인될 때 사용될 세팅 파일 경로
          </li>
          <li>세팅 파일은 Elasticsearch에 색인될 때 사용될 인덱스의 세팅을 정의합니다.</li>
          <li>
            저 같은 경우엔, <code class="inline-code-block">nori</code>
            플러그인을 사용하기 위해
            <code class="inline-code-block">analysis</code>
            ,
            <code class="inline-code-block">tokenizer</code>
             세팅을 추가했습니다.
          </li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">@Id</code>
        <ul>
          <li>Elasticsearch에 색인될 때 사용될 데이터의 식별자</li>
          <li>
            <code class="inline-code-block">@Id</code>
             어노테이션을 사용하지 않으면 Elasticsearch에 색인될 때 자동으로 식별자가 생성됩니다.
          </li>
        </ul>
      </li>
      <li>
        <code class="inline-code-block">@Field</code>
        <ul>
          <li>Elasticsearch에 색인될 때 사용될 데이터의 필드</li>
          <li>
            <code class="inline-code-block">type</code>
             : 데이터의 타입
          </li>
          <li>
            <code class="inline-code-block">name</code>
             : 필드 이름 (= Column 이름)
          </li>
          <li>
            <code class="inline-code-block">analyzer</code>
             : 데이터의 분석기
          </li>
          <li>등등 다양한 옵션을 사용할 수 있습니다.</li>
        </ul>
      </li>
    </ul>
    <details>
      <summary>restaurant-search-mapping.json</summary>

      <div class="code-block">
        <CodeCopy>
          <pre><code
              class="language-json">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"id"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"keyword"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"nori"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"roadAddress"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"nori"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"address"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"nori"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"phoneNumber"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"lat"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"double"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"lon"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"double"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"description"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token string">"nori"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"rating"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"double"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"reviewCount"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"integer"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
        </CodeCopy>
      </div>
    </details>

    <details>
      <summary>restaurant-search-setting.json</summary>

      <div class="code-block">
        <CodeCopy>
          <pre><code
              class="language-json">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token property">"analysis"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"analyzer"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"nori"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"custom"</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token property">"tokenizer"</span><span class="token operator">:</span> <span class="token string">"nori_mixed"</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token property">"filter"</span><span class="token operator">:</span> <span class="token punctuation">[</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">          <span class="token string">"lowercase"</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">          <span class="token string">"stop"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token punctuation">]</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token property">"tokenizer"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token property">"nori_mixed"</span><span class="token operator">:</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"nori_tokenizer"</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token property">"decompound_mode"</span><span class="token operator">:</span> <span class="token string">"mixed"</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">        <span class="token property">"discard_punctuation"</span><span class="token operator">:</span> <span class="token string">"false"</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
        </CodeCopy>
      </div>
    </details>

    <h3 id="document-repository"><a href="#document-repository">Document 클래스를 사용하기 위한 Repository 생성</a></h3>
    <div class="code-block">
      <CodeCopy>
        <pre><code
            class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Repository</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">RestaurantSearchRepository</span> <span class="token keyword">extends</span> <span class="token class-name">ElasticsearchRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RestaurantSearch</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"{\"match_phrase\": {\"address\": \"?0\"}}"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RestaurantSearch</span><span class="token punctuation">></span></span> <span class="token function">findByAddressExactMatch</span><span class="token punctuation">(</span><span class="token class-name">String</span> addressKeyword<span class="token punctuation">,</span> <span class="token class-name">Pageable</span> pageable<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
      </CodeCopy>
    </div>
    <p>마치 JPA를 사용할 때 Repository를 생성하는 것과 비슷합니다.</p>
    <p>
      <code class="inline-code-block">JpaRepository</code>
      대신
      <code class="inline-code-block">ElasticsearchRepository</code>
      를 상속받습니다.
    </p>
    <p>
      이 인터페이스에 기본적인 CRUD 메서드가 정의되어있고, JPA의 JPQL처럼 메서드 이름을 통해 쿼리를 생성할 수 있습니다.
    </p>
    <p>
      또는 <code class="inline-code-block">@Query</code>
       어노테이션을 사용하여 직접 쿼리를 작성할 수도 있습니다.
    </p>
    <h2 id="elasticsearch-api"><a href="#elasticsearch-api">Elasticsearch 검색 API 구현</a></h2>
    <p>
      예시로 <code class="inline-code-block">address</code>
       필드를 기준으로 검색하는 API를 구현해보겠습니다.
    </p>
    <details>
      <summary>RestaurantSearchController.java</summary>

      <div class="code-block titled">
        <h2 class="code-title">RestaurantController.java</h2>
        <CodeCopy>
          <pre><code
              class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@RestController</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@RequiredArgsConstructor</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestaurantController</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RestaurantService</span> restaurantService<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/address"</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">public</span> <span class="token class-name">RestaurantsSliceResponse</span> <span class="token function">getRestaurantsByAddress</span><span class="token punctuation">(</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> keyword<span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">            <span class="token annotation punctuation">@Valid</span> <span class="token class-name">CustomPageRequest</span> customPageRequest</div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token class-name">Pageable</span> pageable <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">              customPageRequest<span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">              customPageRequest<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">              customPageRequest<span class="token punctuation">.</span><span class="token function">getSort</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token keyword">return</span> restaurantService<span class="token punctuation">.</span><span class="token function">getRestaurantsByAddress</span><span class="token punctuation">(</span>keyword<span class="token punctuation">,</span> pageable<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
        </CodeCopy>
      </div>
    </details>
    <details>
      <summary>RestaurantService.java</summary>

      <div class="code-block titled">
        <h2 class="code-title">RestaurantService.java</h2>
        <CodeCopy>
          <pre><code
              class="language-java">{@html String.raw`<div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@Service</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token annotation punctuation">@RequiredArgsConstructor</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestaurantService</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">RestaurantSearchRepository</span> restaurantSearchRepository<span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>readOnly <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token keyword">public</span> <span class="token class-name">RestaurantsSliceResponse</span> <span class="token function">getRestaurantsByAddress</span><span class="token punctuation">(</span><span class="token class-name">String</span> addressKeyword<span class="token punctuation">,</span> <span class="token class-name">Pageable</span> pageable<span class="token punctuation">)</span> <span class="token punctuation">{</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token class-name">Slice</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RestaurantSearch</span><span class="token punctuation">></span></span> slice <span class="token operator">=</span> restaurantSearchRepository<span class="token punctuation">.</span><span class="token function">findByAddressExactMatch</span><span class="token punctuation">(</span>addressKeyword<span class="token punctuation">,</span> pageable<span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RestaurantSliceResponse</span><span class="token punctuation">></span></span> restaurants <span class="token operator">=</span> slice<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">RestaurantSliceResponse</span><span class="token operator">::</span><span class="token function">from</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">  </div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestaurantsSliceResponse</span><span class="token punctuation">(</span>restaurants<span class="token punctuation">,</span> slice<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content">    <span class="token punctuation">}</span></div></div><div class="code-line"><div class="code-linenotation"><span class="no-line-number"></span><span class="no-line-diff"></span></div><div class="code-content"><span class="token punctuation">}</span></div></div>`}</code></pre>
        </CodeCopy>
      </div>
    </details>

    <p>이런식으로 Elasticsearch에 인덱싱만 해두면, 간편하게 검색 API를 구현할 수 있습니다.</p>
    <p>
      전체 코드는 <a href="https://github.com/kingseungil/matgo" rel="external">여기</a>
      에서 확인할 수 있습니다.
    </p>
    <hr />
    <h1 id=""><a href="#">참고</a></h1>
    <ul>
      <li>
        <a href="https://www.slideshare.net/deview/2d1elasticsearch" rel="external">
          https://www.slideshare.net/deview/2d1elasticsearch
        </a>
      </li>
    </ul>
  </article>
</Post>
